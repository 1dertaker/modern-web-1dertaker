function addTag(e,t,i){var n=document.getElementById(e),o="["+t+"]",a=i===!1?"":"[/"+t+"]";if(document.selection){n.focus();var s=document.selection.createRange();s.text=o+s.text+a}else if(n.selectionStart||"0"==n.selectionStart){var r=n.value.substring(0,n.selectionStart);if(a){var c=r+o+n.value.substring(n.selectionStart,n.selectionEnd);n.value=c+a+n.value.substring(n.selectionEnd,n.textLength),setCaretPosition(n,c.length)}else n.value=r+o+n.value.substring(n.selectionStart,n.textLength),setCaretPosition(n,r.length+o.length)}else n.value=o+a,setCaretPosition(n,o.length+a.length)}function addSmiley(e,t){var i=document.getElementById(e);if(document.selection)i.focus(),sel=document.selection.createRange(),sel.text=t;else if(i.selectionStart||"0"==i.selectionStart){var n=i.value.substring(0,i.selectionStart);i.value=n+t+i.value.substring(i.selectionEnd,i.textLength),setCaretPosition(i,n.length+t.length)}else i.value=t,setCaretPosition(i,t.length)}function setCaretPosition(e,t){if(null!=e)if(e.createTextRange){var i=e.createTextRange();i.move("character",t),i.select()}else e.selectionStart?(e.focus(),e.setSelectionRange(t,t)):e.focus()}function number_format(e,t,i,n){e=(e+"").replace(/[^0-9+\-Ee.]/g,"");var o=isFinite(+e)?+e:0,a=isFinite(+t)?Math.abs(t):0,s="undefined"==typeof n?",":n,r="undefined"==typeof i?".":i,c="",l=function(e,t){var i=Math.pow(10,t);return""+(Math.round(e*i)/i).toFixed(t)};return c=(a?l(o,a):""+Math.round(o)).split("."),c[0].length>3&&(c[0]=c[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,s)),(c[1]||"").length<a&&(c[1]=c[1]||"",c[1]+=new Array(a-c[1].length+1).join("0")),c.join(r)}function addn(e){return e<10?"0"+e:""+e}function escapeHTMLEncode(e){var t=document.createElement("div"),i=document.createTextNode(e);return t.appendChild(i),t.innerHTML}function hinfo_init(){console.debug("Hinfo loaded"),hinfo_validation_fields(),searchUser()}function hinfo_validation_fields(){var e=$("#load-tools-button");e.attr("disabled","disabled"),$("#input-identifier").bind("change keyup keydown mouseover click",function(){$(this).val().length>0?e.removeAttr("disabled"):e.attr("disabled","disabled")})}function HabboUser(e,t,i){function n(e,n){$.getJSON("https://www.habbo."+t+"/api"+e,n).fail(function(e){404==e.status&&(a=!0,i())})}var o=this,a=!1;n("/public/users?name="+e,function(e){e?e.uniqueId&&0!=e.profileVisible?n("/public/users/"+e.uniqueId+"/profile",function(e){o.info=e||!1,i()}):(o.info=e,i()):(o.info=!1,i())}),this.checkStatus=function(){return 1==a?"El usuario "+escapeHTMLEncode($("#input-identifier").val())+" no se encuentra en este hotel":null},this.getData=function(e){return("profileVisible"!==e||0!=this.info.profileVisible)&&escapeHTMLEncode(this.info[e]?this.info[e]:this.info.user[e])},this.getDataCount=function(e){return!this.info[e]||"selectedBadges"===e&&!this.info[e]?this.info.user[e].length:this.info[e].length},this.getDataInner=function(e){var t;if(!this.info[e]){if("selectedBadges"!==e||this.info[e])return!1;innerattrselbadge=this.info.user[e];var i="";for(t in innerattrselbadge)i+="<div class='button grey hinfo_badges' rel='tooltip' data-name='"+escapeHTMLEncode(innerattrselbadge[t].name)+"' data-description='"+escapeHTMLEncode(innerattrselbadge[t].description)+"' style='background-image:url(https://images.habbo.com/c_images/album1584/"+escapeHTMLEncode(innerattrselbadge[t].code)+".gif'></div>";return i}if("badges"===e){innerattrbadge=this.info[e],innerattrbadge.sort(function(e,t){return e.code==t.code?0:e.code>t.code?1:-1});var n="";for(t in innerattrbadge)n+="<div class='button grey hinfo_badges' rel='tooltip' data-name='"+escapeHTMLEncode(innerattrbadge[t].name)+"' data-description='"+escapeHTMLEncode(innerattrbadge[t].description)+"' style='background-image:url(https://images.habbo.com/c_images/album1584/"+escapeHTMLEncode(innerattrbadge[t].code)+".gif'></div>";return n}if("friends"===e){innerattrfriend=this.info[e];var o="";for(t in innerattrfriend)null!=innerattrfriend[t].motto&&void 0!=innerattrfriend[t].motto||""==innerattrfriend[t].motto,o+="<div class='button-group hinfo_friends_group'><div class='button grey active hinfo_friends' style='background-image:url(https://www.habbo.com/habbo-imaging/avatarimage?figure="+escapeHTMLEncode(innerattrfriend[t].figureString)+"&headonly=1)'></div><div class='button hinfo_friends'><span><b><a href='https://www.habbo."+$("#input-hotel").val()+"/profile/"+escapeHTMLEncode(innerattrfriend[t].name)+"' target='_blank'>"+escapeHTMLEncode(innerattrfriend[t].name)+"</a></b></span><span>"+escapeHTMLEncode(innerattrfriend[t].motto)+"</span></div></div>";return o}if("groups"===e){innerattrgroup=this.info[e];var a="";for(t in innerattrgroup)void 0!=innerattrgroup[t].primaryColour&&null!=innerattrgroup[t].primaryColour||(innerattrgroup[t].primaryColour="FFF"),void 0!=innerattrgroup[t].secondaryColour&&null!=innerattrgroup[t].secondaryColour||(innerattrgroup[t].secondaryColour="FFF"),"CLOSED"==innerattrgroup[t].type?innerattrgroup[t].type="<i class='hinfo_closedg glyphicons glyphicons-lock'></i> ":"EXCLUSIVE"==innerattrgroup[t].type?innerattrgroup[t].type="<i class='hinfo_excluvg glyphicons glyphicons-keys'></i> ":innerattrgroup[t].type="",1==innerattrgroup[t].isAdmin?innerattrgroup[t].isAdmin="<i class='hinfo_admingroup glyphicons glyphicons-star'></i>":innerattrgroup[t].isAdmin="",a+="<div class='button-group hinfo_groups_group'><div class='button grey active hinfo_groups' style='background-image:url(https://www.habbo.com/habbo-imaging/badge/"+escapeHTMLEncode(innerattrgroup[t].badgeCode)+".gif)'><div class='button-group hinfo_groups_colors'><span class='button' style='background-color:#"+escapeHTMLEncode(innerattrgroup[t].primaryColour)+";'></span><span class='button' style='background-color:#"+escapeHTMLEncode(innerattrgroup[t].secondaryColour)+";'></span></div></div><div class='button hinfo_groups'>"+innerattrgroup[t].isAdmin+"<span>"+innerattrgroup[t].type+" <a href='https://www.habbo."+escapeHTMLEncode($("#input-hotel").val())+"/hotel?room="+escapeHTMLEncode(innerattrgroup[t].roomId)+"' target='_blank'><b>"+escapeHTMLEncode(innerattrgroup[t].name)+"</b></a></span><span>"+escapeHTMLEncode(innerattrgroup[t].description)+"</span></div></div>";return a}if("rooms"===e){innerattrroom=this.info[e],innerattrroom.sort(function(e,t){return e.name==t.name?0:e.name>t.name?1:-1});var s="";for(t in innerattrroom)null!=innerattrroom[t].description&&void 0!=innerattrroom[t].description||(innerattrroom[t].description=""),s+="<div class='button-group hinfo_rooms_group'><div class='button grey active hinfo_rooms' style='background-image:url("+escapeHTMLEncode(innerattrroom[t].thumbnailUrl)+"), url(/images/room_noimg.png)'><div class='button-group hinfo_rooms_misc'><span class='button green active'><i class='glyphicons glyphicons-thumbs-up'></i> "+escapeHTMLEncode(innerattrroom[t].rating)+"</span><span class='button red active'><i class='glyphicons glyphicons-user'></i> "+escapeHTMLEncode(innerattrroom[t].maximumVisitors)+"</span></div></div><div class='button hinfo_rooms'><span><a href='https://www.habbo."+escapeHTMLEncode($("#input-hotel").val())+"/hotel?room="+escapeHTMLEncode(innerattrroom[t].id)+"' target='_blank'><b>"+escapeHTMLEncode(innerattrroom[t].name)+"</b></a></span><span>"+escapeHTMLEncode(innerattrroom[t].description)+"</span></div></div>";return s}if("selectedBadges"===e&&this.info[e]){innerattrselbadge=this.info[e];var i="";for(t in innerattrselbadge)i+="<div class='button grey hinfo_badges' rel='tooltip' data-name='"+escapeHTMLEncode(innerattrselbadge[t].name)+"' data-description='"+escapeHTMLEncode(innerattrselbadge[t].description)+"' style='background-image:url(https://images.habbo.com/c_images/album1584/"+escapeHTMLEncode(innerattrselbadge[t].code)+".gif'></div>";return i}}}function searchUser(){$("#load-tools-button").click(function(){$("#load-tools-response").html('<div class="box box-big"><div class="body"><center><div class="img-ajax-loader"><img src="/images/loading.gif" class="img-ajax-loader" /></div></center></div></div>'),user=new HabboUser(escapeHTMLEncode($("#input-identifier").val()),escapeHTMLEncode($("#input-hotel").val()),function(){$("#hinfo-site > #load-tools-response").html('<div class="box box-big"><div id="hinfo-body" class="body"></div></div>');var e=$("#hinfo-body.body"),t="";if(null!=user.checkStatus())e.html('<div class="button grey big" style="text-align:center;width:100%;">'+user.checkStatus()+"</div>"),console.error("Status: "+user.checkStatus());else{var i=new Date(user.getData("memberSince")),n=addn(i.getDate())+"/"+addn(i.getMonth()+1)+"/"+i.getFullYear()+" "+addn(i.getHours())+":"+addn(i.getMinutes())+":"+addn(i.getSeconds()),o="";if(o+='<div id="hinfo-summary" class="button-group body">',o+='<div class="hinfo_summary button grey active" style="background-image:url(https://www.habbo.com/habbo-imaging/avatarimage?figure='+user.getData("figureString")+')"></div>',o+='<div class="hinfo_summary button">',o+="<span><b>ID</b>: "+user.getData("uniqueId")+"</span>",o+='<span><b>Nombre</b>: <a href="https://www.habbo.'+escapeHTMLEncode($("#input-hotel").val())+"/profile/"+user.getData("name")+'" target="_blank"><b>'+user.getData("name")+"</b></a></span>",o+="<span><b>Misión</b>: "+user.getData("motto")+"</span>",o+="<span><b>Fecha de creación</b>: "+n+"</span>",o+=0==user.getDataCount("selectedBadges")?'<div class="hinfo_summary_badges button grey big">Este usuario no tiene placas seleccionadas</div>':'<div class="hinfo_summary_badges button-group">'+user.getDataInner("selectedBadges")+"</div>",o+="</div>",o+="</div>",t+=o,0==user.getData("profileVisible"))t+='<div class="button grey big">No podemos acceder a las placas, los amigos, las salas y los grupos de este usuario porque su perfil está cerrado.</div>';else{var a=["",""],s=["",""],r=["",""],c=["",""];user.getDataCount("badges")>=250&&(a=["style='cursor:pointer;' onclick=$('#hinfo-badges').toggle();","style='display:none;'"]),user.getDataCount("friends")>=70&&(s=["style='cursor:pointer;' onclick=$('#hinfo-friends').toggle();","style='display:none;'"]),user.getDataCount("groups")>=20&&(r=["style='cursor:pointer;' onclick=$('#hinfo-groups').toggle();","style='display:none;'"]),user.getDataCount("rooms")>=10&&(c=["style='cursor:pointer;' onclick=$('#hinfo-rooms').toggle();","style='display:none;'"]),t+='<div id="hinfo-bhead" '+a[0]+' class="button orange active big">Placas ('+user.getDataCount("badges")+")</div>",t+='<div id="hinfo-badges" '+a[1]+' class="body">'+user.getDataInner("badges")+"</div>",t+='<div id="hinfo-fhead" '+s[0]+' class="button red active big">Amigos ('+user.getDataCount("friends")+")</div>",t+='<div id="hinfo-friends" '+s[1]+' class="body">'+user.getDataInner("friends")+"</div>",t+='<div id="hinfo-ghead" '+r[0]+' class="button green active big">Grupos ('+user.getDataCount("groups")+")</div>",t+='<div id="hinfo-groups" '+r[1]+' class="body">'+user.getDataInner("groups")+"</div>",t+='<div id="hinfo-rhead" '+c[0]+' class="button blue active big">Salas ('+user.getDataCount("rooms")+")</div>",t+='<div id="hinfo-rooms" '+c[1]+' class="body">'+user.getDataInner("rooms")+"</div>"}e.html(t),console.log("Status: Usuario encontrado -OK")}})})}function binfo_init(){console.debug("BadgesInfo loaded."),binfo_init_validation_fields(),binfo_init_ajax_response()}function binfo_init_validation_fields(){var e=$("#load-tools-button");e.attr("disabled","disabled"),$("#input-badge-code").bind("change keyup keydown mouseover click",function(){$(this).val().length>0?e.removeAttr("disabled"):e.attr("disabled","disabled")})}function binfo_init_ajax_response(){var e=null;$("#load-tools-button").click(function(){null!=e&&e.abort();var t=$("#binfo-site > #load-tools-response"),i=$("#input-badge-code").val(),n=$("#input-hotel").val();$(t).html('<div class="box box-big"><div class="body"><center><div class="img-ajax-loader"><img src="/images/loading.gif" class="img-ajax-loader" /></div></center></div></div>'),e=$.ajax({url:"//utilities.habtium.com/tools/loadTools.html",type:"POST",data:{t:"binfo",badge_code:i,hotel:n},dataType:"html"}),e.done(function(e){$(t).hide(),$(t).html(e),$(t).fadeIn("7000"),hinfo_init_look_rotate()}),e.fail(function(e,i){console.debug("Request failed: "+i),$(t).html(i)})})}function fgenerator_init(){console.debug("FontGenerator loaded."),fgenerator_generate_font()}function fgenerator_generate_font(){function e(e){o=$(e).attr("id"),o=o.substr(5,o.length)}function t(){n=$("#input-text-to-generate").val(),""==n&&(n=null)}function i(){var e=null,t=null,i=null;null!=n&&null!=o&&(e='<img id="output-image" />',$("#output-text-generated").html(e),i="//utilities.habtium.com/font_generator/?font="+o+"&spacing="+a[o-1]+"&text="+n,$("#output-image").attr("src",i),t='<center><a class="button green" style="width:100%;" href="'+i+'&download" target="_blank">Haz clic aquí para descargar</a></center>',$("#download-text-generated").html(t))}var n=null,o=null,a=new Array(-10,0,-2,-2,-15,-15,-15,1,-5,0,0,0,0,0,0,0,-2,1,0,0,-5,-13,0,-5,0,-2,0,0,1,0,0,0,0,0,1,-4,0,-1,0,0,-2,1,1,0,1,1,1,1,1,1,1,-2,-5,1,-2,-1);$("#input-text-to-generate").keypress(function(e){13==e.keyCode&&(t(),i())}),$(".font-preview li").click(function(){e($(this)),t(),i()})}function hcreator_init(){hcreator_generate_habbo()}function hcreator_generate_habbo(){function e(){$(".habbo").attr("src","https://www.habbo."+d+"/habbo-imaging/avatarimage?user="+l+"&direction="+s+"&head_direction="+a+"&gesture="+i[r]+"&action="+t[o]+"&size="+n[c])}var t=new Array("","wav","wlk","sit","lay","crr=1","crr=2","crr=3","crr=4","crr=5","crr=6","crr=9","crr=33","crr=44","drk=1","drk=2","drk=3","drk=4","drk=5","drk=6","drk=9","drk=33","drk=44","sit,crr=1","sit,crr=2","sit,crr=3","sit,crr=4","sit,crr=5","sit,crr=6","sit,crr=9","sit,crr=33","sit,crr=44","sit,drk=1","sit,drk=2","sit,drk=3","sit,drk=4","sit,drk=5","sit,drk=6","sit,drk=9","sit,drk=33","sit,drk=44"),i=new Array("sml","sad","agr","srp","eyb",""),n=new Array("l","n","s"),o=0,a=3,s=3,r=0,c=0,l="chimechu",d="es";$("#start").click(function(){d=$("#hotel").val(),""!==$("#habboname").val()&&(l=$("#habboname").val()),e()}),$(".right").click(function(){var i=$(this).parent().attr("id");"options-body"==i?(s--,s<1&&(s=9)):"options-head"==i?(a--,a<1&&(a=9)):"options-gesture"==i?(r--,r<0&&(r=5)):"options-action"==i?(o--,o<0&&(o=t.length-1)):"options-size"==i&&(c--,c<0&&(c=2)),e()}),$(".left").click(function(){var i=$(this).parent().attr("id");"options-body"==i?(s++,s>9&&(s=1)):"options-head"==i?(a++,a>9&&(a=1)):"options-gesture"==i?(r++,r>5&&(r=0)):"options-action"==i?(o++,o>t.length-1&&(o=0)):"options-size"==i&&(c++,c>2&&(c=0)),e()})}String.prototype.ucFirst=function(){return this.charAt(0).toUpperCase()+this.slice(1)};var Messages={opened:!1,init:function(){$("#btn-messages").click(function(){Messages.opened?Messages.close():Messages.open()});var e=0;Status.add("messages",function(t){t.count&&t.count.messages!=e&&(0==t.count.messages?$("#btn-messages > .count").hide():$("#btn-messages > .count").html(t.count.messages).css("display","block"),History.notifications+=-e+parseInt(t.count.messages),History.reloadNotifications(),e=t.count.messages)})},changeInfoPage:function(e,t){History.push({path:e},t,e),History.changeTitle(t)},onChangeHistory:function(e){},open:function(e,t){function i(){e?$("main").html('<div id="pmsg-box" style="position:;"><div id="pmsg-conversations"></div><div id="pmsg-conversation"></div><div class="clear"></div></div>'):(Header.fixed=!0,$("#menu").css("position","fixed").css("top",0),$("header").hide(),$("body").css("overflow","hidden"),$("body").append('<div id="pmsg-exterior"></div><div id="pmsg-box"><div id="pmsg-conversations"></div><div id="pmsg-conversation" style="position: relative;"><div style="text-align: center;color: rgba(128, 128, 128, 0.6);font-size: 20px;position: absolute;top: 50%;width: 100%;">Selecciona una conversación</div></div><div class="clear"></div></div>'),$("#pmsg-exterior").click(function(){Messages.close()})),$("#pmsg-conversations").html('<div class="box box-small" style="padding: 10px;"><input type="text" id="pmsg-search" placeholder="Empieza a hablar con..."><div style="display:none;" id="autocomplete"></div></div><div class="body"><div style="margin: 15px 0;text-align: center;"><img src="//cdn.habtium.com/management/ajax-loader.gif" style=""></div></div>');var t=function(){$("#autocomplete").slideUp("fast").html(""),$("#pmsg-conversations > .body").show()},i=$("#pmsg-search").focus();$(i).keyup(function(){var e=$(i).val();e.length>1?Api.get("/accounts/autocomplete",{string:e,limit:5},function(e){if(!e.error){var n="";for(var o in e)Accounts.stored[e[o].id]=e[o],n+='<div data-id="'+e[o].id+'" class="ui-account conversation account-suggestion"><div class="avatar" style="background-image:url('+e[o].avatar+');"></div><div class="body" style="text-overflow:ellipsis;"><span><h1>'+e[o].username+"</h1> <h2>"+e[o].nick+"</h2></span></div></div>";$("#pmsg-conversations > .body").hide(),$("#autocomplete").html(n+'<div class="clear"></div>').slideDown("fast");var a=Messages.responsiveness;$(".account-suggestion").click(Messages.read).click(function(){$(i).val(""),t(),a.smallMode&&a.enterInConversation()})}}):t()});Api.get("/messages",{},function(e){Accounts.getByAccountIfNot(e,function(){$("#pmsg-conversations > .body").html(""),Messages.put(e)}),Messages.autoUpdate()}),window.onresize=Messages.responsiveness.adjust}t&&(this.userToOpen=t),e||(this.prevUrl=window.location.href,this.prevTitle=History.title,Language.get("messages").then(function(e){Messages.changeInfoPage("/messages",e[0]+" › Habtium")}),window.addEventListener("popstate",this.onChangeHistory)),Messages.opened=!0,$(document).scrollTop()<106?$("body").animate({scrollTop:"106px"},200,i):i()},responsiveness:{smallMode:!1,enterInConversation:function(){$("#pmsg-conversations").hide(),$("#pmsg-back").show().click(function(){$("#pmsg-conversations").show()})},adjust:function(e){function t(){i.smallMode=!1,$("#pmsg-back").hide().unbind("click"),$(".conversation").unbind("click.responsiveness"),$("#pmsg-conversations").show(),$("#pmsg-conversation").show()}var i=Messages.responsiveness;e===!0&&t(),window.innerWidth<600&&!i.smallMode?(i.smallMode=!0,Messages.actualConversation?i.enterInConversation():$("#pmsg-conversations").show(),$(".conversation").bind("click.responsiveness",function(){i.enterInConversation()})):window.innerWidth>=600&&i.smallMode&&t()}},put:function(e){var t="";for(var i in e){var n=accounts[e[i].account.id];t+='<div data-new data-id="'+n.id+'" data-id-message="'+e[i].id+'" class="conversation'+(0==e[i].seen&&1==e[i].incoming?" unseen":"")+'" style="'+(0==e[i].seen&&1==e[i].incoming?"background-color:rgb(253, 241, 201);":"")+'">\t\t\t<div class="avatar" style="background-image:url('+n.avatar+');"></div>\t\t\t<div class="body">'+(n.name!=n.nick?"<h1>"+n.name+"</h1> <h2>"+n.nick+"</h2>":"<h1>"+n.nick+"</h1>")+"<br /><span>"+e[i].message+'</span></div>\t\t\t<div class="clear"></div></div>'}$("#pmsg-conversations > .body").append(t);var o=$("#pmsg-conversations > .body").children("[data-new]");if(o.removeAttr("data-new").click(Messages.read),this.userToOpen){this.userToOpen;this.userToOpen=null}Messages.responsiveness.adjust(!0)},read:function(e){function t(){var e=!1;$("#pmsg-form").submit(function(e){e.preventDefault();var t=$("#pmsg-form").children("input,textarea"),i=t.first().val().trim();i&&(t.prop("disabled",!0),Api.post("/messages/"+n,{message:i},function(e){e.error||t.first().val("").focus(),Messages.update(),t.prop("disabled",!1),setCaretPosition($("#pmsg-form > textarea"),0)}))}).children("textarea").keydown(function(t){16===t.which?e=!0:e||13!==t.which||$("#pmsg-form").submit()}).keyup(function(t){13!==t.which&&(e=!1)}),setCaretPosition($("#pmsg-form > textarea"),0)}function i(e){o=!0,e.prepend('<div class="loading" style="text-align: center;"><img src="//cdn.habtium.com/management/ajax-loader.gif" style=""></div>');var t=$(".messages-message:first");Api.get("/messages/"+Messages.actualConversation,{first:t.data("id")},function(i){i.error?e.children(".loading").remove():($("#pmsg-messages").prepend(Messages.getHTMLMessages(i)),o=!1,e.children(".loading").remove(),e.scrollTop(t.offset().top-230))})}$("#pmsg-form")&&$("#pmsg-form").unbind("submit").unbind("scroll");var n=$(this).data("id");n?($(".conversation").removeClass("active"),$(this).css("transition","background 1s").css("background-color","").addClass("active")):n=e,Messages.actualConversation=n,Language.get("messages").then(function(e){Messages.changeInfoPage("/messages/"+accounts[n].username,accounts[n].name+" - "+e[0]+" › Habtium")}),$("#pmsg-conversation").html('<div class="head"><span id="pmsg-back" class="glyphicons glyphicons-show-thumbnails-with-lines" style="display: none;"></span><span style="display: table-cell;vertical-align: middle;"><h1 style="font-size: 25px;display: inline;"><a href="/'+accounts[n].username+'" style="color: rgb(55, 55, 55);">'+accounts[n].name+"</a></h1>"+(accounts[n].name!=accounts[n].nick?' <h2 style="font-size: 16px;display: inline;">'+accounts[n].nick+"</h2>":"")+'</span></div><div class="body"><div id="pmsg-messages" style="position: absolute;bottom: 0;width: 100%;"></div></div>\t\t\t<div class="footer"><form action="javascript:void(0);" id="pmsg-form" method="post"><div class="avatar" style="background-image:'+$("#avatar-header").css("background-image").replace(/"/g,"'")+';"></div><textarea class="form-control" value="" placeholder="Escribe un mensaje a '+accounts[n].name+'..." maxlength="900" required=""></textarea><input class="button" type="submit" name="message" value="Enviar"></form></div>');var o=!0;Api.get("/messages/"+n,{limit:15},function(e){e.error?t():Accounts.getByAccountIfNot(e,function(){$("#pmsg-messages").html(Messages.getHTMLMessages(e)),Messages.scrollDown(!0),o=!1,setTimeout(function(){$("#pmsg-conversation > .body").height()-$("#pmsg-messages").height()>30&&i($("#pmsg-conversation > .body")),$("#pmsg-conversation > .body").scroll(function(){var e=$(this);!o&&e.scrollTop()<30&&i(e)})},1e3),t()})})},getHTMLMessages:function(e){for(var t,i=new Date,n=i.getDate()+"/"+i.getMonth()+"/"+i.getFullYear(),o=i.getDate(),a="",s=e.length-1;s>=0;s--){var r=accounts[e[s].account.id],c=new Date(1e3*e[s].time),l=c.getDate()+"/"+c.getMonth()+"/"+c.getFullYear(),d=c.getMinutes();d<10&&(d="0"+d);var u=t&&l!==t;u&&(a+='<div class="clear"></div><div class="messages-day">',l==n?Language.get("today").then(function(e){a+=e[0].ucFirst()}):l==c.getDate()-1+"/"+c.getMonth()+"/"+c.getFullYear()?Language.get("yesterday").then(function(e){a+=e[0].ucFirst()}):a+=c.getDate()>o-7&&c.getMonth()+"/"+c.getFullYear()==i.getMonth()+"/"+i.getFullYear()?Time.getDayName(c.getDay()).ucFirst():l,a+="</div>"),t&&!u||(t=l),a+='<div data-id="'+e[s].id+'" data-time="" onclick="$(this).children(\'.messages-time\').toggle();" class="messages-message box" style="float: '+(1==e[s].incoming?"left":"right")+';clear: both;">'+(1==e[s].incoming?'<div class="avatar" style="background-image:url('+r.avatar+');"></div>':"")+'<div class="text">'+e[s].message+'<div class="time" style="float: right;color: rgb(168, 168, 168);margin: 6px 0 -2px 10px;font-size: 10px;">'+c.getHours()+":"+d+'</div></div><div class="clear"></div></div>'}return a},update:function(){var e=$(".conversation").first().data("id-message");Api.get("/messages",{last:e},function(e){for(var t=e.length-1;t>=0;t--){var i=$('.conversation[data-id="'+e[t].account.id+'"]');i?(i.data("id-message",e[t].id).prependTo("#pmsg-conversations > .body"),i.children(".body").children("span").html(e[t].message),1==e[t].incoming&&0==e[t].seen&&i.css("background-color","rgb(253, 241, 201)")):Messages.put(e[t])}});var t=$(".messages-message").last().data("id");t&&Api.get("/messages/"+Messages.actualConversation,{last:t},function(e){e.error||($("#pmsg-messages").append(Messages.getHTMLMessages(e)),Messages.scrollDown(!0))})},autoUpdate:function(){this.interval=setInterval(Messages.update,5e3)},scrollDown:function(e){var t=$("#pmsg-conversation > .body");$(t)[0].scrollHeight&&(e?t.scrollTop($(t)[0].scrollHeight):t.animate({scrollTop:$(t)[0].scrollHeight}))},close:function(){clearInterval(Messages.interval),$("#pmsg-exterior").remove(),$("#pmsg-box").remove(),$("header").show(),$("body").css("overflow",""),Messages.actualConversation=void 0,Messages.opened=!1,Messages.changeInfoPage(this.prevUrl,this.prevTitle)}},Accounts={stored:[],get:function(e,t){Api.get("/accounts",{accounts:e},function(e){for(var i in e)Accounts.stored[e[i].id]=e[i];t()})},getIfNot:function(e,t){for(var i=[],n=0;n<e.length;n++)Accounts.stored[e[n]]||i.push(e[n]),n==e.length-1&&(i.length>0?Accounts.get(i,t):t())},getByAccountIfNot:function(e,t){for(var i=[],n=0;n<e.length;n++)Accounts.stored[e[n].account.id]||i.push(e[n].account.id),n==e.length-1&&(i.length>0?Accounts.get(i,t):t())}},accounts=Accounts.stored,Alert={started:!1,stack:[],start:function(){Alert.started||(Alert.started=!0,function e(){if(0==Alert.stack.length)Alert.started=!1;else{var t=Alert.stack[0];$('<div class="alert-fix alert-fix-'+t.type+'" '+(t.onClose?'onclick="'+t.onClose+'"':"")+'>\t\t\t\t\t\t<div class="alert-fix-icon">\t\t\t\t\t\t\t<span class="glyphicons glyphicons-'+t.icon+'"></span>\t\t\t\t\t\t</div>\t\t\t\t\t\t<div '+(t.link?"onclick=\"window.location.href='"+t.link+"'\" ":"")+'class="alert-fix-text">'+t.text+"</div>\t\t\t\t\t</div>").appendTo("#alert-container").show().addClass("animated bounceInRight").click(function(){var e=$(this).addClass("animated bounceOutRight");setTimeout(function(){e.remove()},500)}),Alert.stack.shift(),setTimeout(e,400)}}())},push:function(e){[].push.apply(Alert.stack,e),Alert.start()}},Api={uri:"https://api.habtium.com/v1",request:function(e,t,i,n){$.ajax({type:e,url:this.uri+t,data:i,headers:App.getSessionToken()?{Authorization:"token "+App.getSessionToken()}:{}}).done(function(e){n(e)})},get:function(e,t,i){this.request("GET",e,t,i)},put:function(e,t,i){this.request("PUT",e,t,i)},post:function(e,t,i){this.request("POST",e,t,i)},delete:function(e,t,i){this.request("DELETE",e,t,i)}},App={version:$("html").data("version"),account_id:$("html").data("account"),isLogged:function(){return 0!=this.account_id},get:function(e){return window.location.pathname.split("/")[e]},hash:function(){return window.location.hash.substring(1)},getSessionToken:function(){for(var e="session=",t=document.cookie.split(";"),i=0;i<t.length;i++){var n=t[i].trim();if(0==n.indexOf(e))return n.substring(e.length,n.length)}return""},echo:function(e,t){document.write(e)},formatNumber:function(e,t){return("0"+e).slice(0-t)},startInterval:function(e,t){return e(),setInterval(e,t)}},Comments={lock:!1,init:function(e,t){function i(i,n){Language.get(["achievements."+n.achievement+".name","achievements."+n.achievement+".description"]).then(function(o){$("#_content")[i]('<a name="'+n.id+'"></a><div id="comment-'+n.id+'" class="box box-'+("profile"==e?"medium":"big")+' item-top comment" data-id="'+n.id+'" style="overflow:visible;"><div class="account-box'+(n.online?" online":" offline")+'"><div class="avatar" style="background-image:url('+n.avatar+');"><a href="/'+n.username+'"></a></div>'+(0!=n.achievement?'<div class="achievement" rel="tooltip" data-name="'+o[0]+'" data-description="'+o[0]+'" style="background-image:url(/images/hexagon_grey.png), url(//cdn.habtium.com/achievements/'+n.achievement+'.png);"><a href="/'+n.username+"/achievements#"+n.achievement+'"></a></div>':"")+(!n.approved&&n.account==App.account_id||"profile"==e&&t==App.account_id?'<div class="button grey" onclick="Comments.delete('+n.id+');"><span class="halflings halflings-trash"></span></div>':"")+'<div class="body"><span>'+(n.name!=n.nick?'<h1><a href="/'+n.username+'">'+n.name+"</h1></a> <i>"+n.nick+"</i>":'<h1><a href="/'+n.username+'">'+n.nick+"</a></h1>")+"<h2>"+Time.getHTML(n.time)+'</h2></span></div></div><div class="body text">'+n.content+"</div></div>")})}Comments.lock=!0,Api.get("/comments",{item:e,id:t},function(e){if(!e.error)for(var t=0;t<e.data.length;t++)i("append",e.data[t]);Comments.lock=!1}),$("#comments_form").submit(function(i){i.preventDefault(),Comments.lock||(Comments.lock=!0,Api.post("/comments",{item:e,id:t,content:$("#comment_content").attr("disabled",!0).val()},function(t){if(t.error)switch(t.error.identifier){case"internal_error":Alert.push([{type:"danger",text:"¡Hey! Hubo un error al intentar enviar tu comentario. Vuelve a intentarlo.",icon:"warning-sign"}]);break;case"request_verify_2_error":Alert.push([{type:"danger",text:"¡Hey! Ya publicaste este comentario antes.",icon:"warning-sign"}]);break;case"request_verify_1_error":Alert.push([{type:"danger",text:"¡Hey! Has publicado un comentario hace menos de 10 segundos.",icon:"warning-sign"}]);break;case"request_parameter_too_long/content":Alert.push([{type:"danger",text:"¡Hey! El contenido de tu comentario es demasiado largo. La máxima longitud de un comentario es de 300 carácteres.",icon:"warning-sign"}]);break;case"request_parameter_empty/content":Alert.push([{type:"danger",text:"¡Hey! Parece que has intentado enviar un comentario vacío.",icon:"warning-sign"}])}else $("#comment_content").val(""),Language.get(["achievements."+t.achievement+".name","achievements."+t.achievement+".description"]).then(function(i){$("#_content").prepend('<a name="'+t.id+'"></a><div id="comment-'+t.id+'" class="box box-'+("profile"==e?"medium":"big")+' item-top animated bounceInDown" style="overflow:visible;"><div class="account-box online"><div class="avatar" style="background-image:url('+t.avatar+');"><a href="/'+t.username+'"></a></div><div class="achievement" rel="tooltip" data-name="'+i[0]+'" data-description="'+i[1]+'" style="background-image:url(/images/hexagon_grey.png), url(//cdn.habtium.com/achievements/'+t.achievement+'.png);"><a href="/'+t.username+"/achievements#"+t.achievement+'"></a></div><div class="button grey" onclick="Comments.delete('+t.id+');"><span class="halflings halflings-trash"></span></div><div class="body"><span>'+(t.name!=t.nick?'<h1><a href="/'+t.username+'">'+t.name+"</h1></a> <i>"+t.nick+"</i>":'<h1><a href="/'+t.username+'">'+t.nick+"</a></h1>")+"<h2>"+Time.getHTML(t.time)+'</h2></span></div></div><div class="body text">'+t.content+"</div>")});$("#comment_content").attr("disabled",!1),Comments.lock=!1}))}),$(window).scroll(function(){$(window).height()+$(window).scrollTop()==$(document).height()&&(Comments.lock||(Comments.lock=!0,Api.get("/comments",{item:e,id:t,last:$(".comment:last").data("id")},function(e){if(!e.error)for(var t=0;t<e.data.length;t++)i("append",e.data[t]);Comments.lock=!1})))})},delete:function(e){Api.delete("/comments/"+e,{},function(t){$("#comment-"+e).fadeOut().remove()})}},Header={fixed:!1,init:function(){$("#avatar-header").dblclick(function(){$("#go-profile")[0].click()});var e=$("#menu").offset().top;$(window).scroll(function(){var t=$(window).scrollTop()>e;t&&!Header.fixed?(Header.fixed=!0,$("#menu").css("position","fixed").css("top","0")):!t&&Header.fixed&&(Header.fixed=!1,$("#menu").css("position","").css("top",""))})}},History={title:document.title,notifications:0,parseTitle:function(e){return(this.notifications>0?"("+this.notifications+") ":"")+e},changeTitle:function(e){this.title=e,document.title=this.parseTitle(e)},replace:function(){},push:function(e,t,i){history.pushState(e,t,i)},reloadNotifications:function(){document.title=this.parseTitle(this.title)}},Language={code:$("html").attr("lang"),strings:{},init:function(){Storage&&App.version==Lockr.get("app.version")&&Language.code==Lockr.get("app.language_code")&&(Language.strings=Lockr.get("app.language_strings"))},get:function(e){return new Promise(function(t){var i={};Array.isArray(e)||(e=[e]),e.forEach(function(n,o){var a,s,r,c=n;Array.isArray(n)&&(c=n[0],r=n[1]),c=c.split("."),s=c.shift(),c=c.join("."),""===c&&(c=s);var l=function(){a=Language.strings[s][c],r&&r instanceof Object&&Object.keys(r).length>0&&$.each(r,function(e,t){a=a.replace("%"+e+"%",t);

})},d=function(){i[o]=a,i[c]=a,o===e.length-1&&t(i)};Language.strings[s]?(Language.strings[s][c]?l():a=c,d()):Language.getFile(s).then(function(){Language.strings[s]&&Language.strings[s][c]?l():a=c,d()},function(){a=c,d()})})})},getFile:function(e){return new Promise(function(t,i){$.getJSON("/lang/"+Language.code+"/"+e+".json?"+App.version).done(function(i){Language.strings[e]=i,"undefined"!=typeof Storage&&(Lockr.set("app.version",App.version),Lockr.set("app.language_code",Language.code),Lockr.set("app.language_strings",Language.strings)),t()}).fail(i)})}},Likes={init:function(e){$(".likes-"+e).each(function(){var t=$(this);Api.get("/likes/status/"+e+"/"+t.data("id"),{},function(i){App.isLogged()?i.liked?t.attr("data-liked",1).addClass("active"):t.attr("data-liked",0):t.addClass("disabled"),"profile"==e&&t.data("id")==App.account_id&&t.addClass("disabled"),t.html('<span class="glyphicons glyphicons-'+("profile"==e?"heart":"thumbs-up")+'"></span> '+(i.amount>0?'<span class="likes-count">'+i.amount+"</span>":""))})}),$(".likes-"+e).click(function(){var t=$(this);App.isLogged()&&(0==t.data("liked")?Api.post("/likes/"+e+"/"+t.data("id"),{},function(e){e.success&&t.addClass("active").attr("data-liked",1).children(".likes-count").html(parseInt(t.children(".likes-count").html())+1)}):1==t.data("liked")&&Api.delete("/likes/"+e+"/"+t.data("id"),{},function(e){e.success&&t.removeClass("active").attr("data-liked",0).children(".likes-count").html(parseInt(t.children(".likes-count").html())-1)}))})}},Notifications={init:function(){$("#btn-notifications").click(function(){Notifications.opened?Notifications.close():Notifications.open()});var e=0;Status.add("notifications",function(t){t.count&&t.count.notifications!=e&&(0==t.count.notifications?$("#btn-notifications > .count").hide():$("#btn-notifications > .count").html(t.count.notifications).css("display","block"),History.notifications+=-e+parseInt(t.count.notifications),History.reloadNotifications(),e=t.count.notifications)})},open:function(){Notifications.opened=!0,$("body").append('<div id="notifications-background"></div>'),$("#header-account > .btn-group").append('<div id="notifications-box"><div class="arrow"><div></div></div><div class="content"><div class="body" style="padding: 25px 0;text-align: center;"><img src="//cdn.habtium.com/management/ajax-loader.gif" style=""></div></div></div>');var e=!1;Api.get("/notifications",{},function(t){if($("#notifications-box").click(function(e){return e.stopPropagation(),!1}),$(document).click(Notifications.close),t.error){var i="empty_set"==t.error.identifier?"notifications_empty_set":"notifications_error";Language.get(i).then(function(e){$("#notifications-box > .content").html('<div class="body" style="padding: 25px 0;text-align: center;">'+e[0]+"</div>")})}else Accounts.getByAccountIfNot(t,function(){$("#notifications-box > .content").html('<div class="body"></div>'),Notifications.put(t,"append"),$("#notifications-box > .content > .body").scroll(function(){var t=$(this);!e&&t.scrollTop()+t.innerHeight()>=$(this)[0].scrollHeight-10&&(e=!0,t.append('<div class="loading" style="text-align: center;"><img src="//cdn.habtium.com/management/ajax-loader.gif" style=""></div>'),Api.get("/notifications",{first:$(".notification:last").data("id")},function(i){i.error?t.children(".loading").remove():Accounts.getByAccountIfNot(i,function(){Notifications.put(i,"append"),e=!1,t.children(".loading").remove()})}))})})})},put:function(e,t){var i="";for(var n in e){var o,a,s=accounts[e[n].account.id];switch(e[n].type){case 1:o="%USER% ha comenzado a seguirte.",a="/"+s.username;break;case 2:switch(o="%USER% te ha mencionado en %PLACE%.",e[n].place){case 1:o=o.replace("%PLACE%","un tema del foro"),a=e[n].params.url;break;case 2:o=o.replace("%PLACE%","una noticia"),a=e[n].params.url;break;case 3:o=o.replace("%PLACE%","un evento"),a=e[n].params.url;break;case 4:o=o.replace("%PLACE%","un artículo"),a=e[n].params.url;break;case 5:o=o.replace("%PLACE%","un blog"),a=e[n].params.url;break;case 6:o=o.replace("%PLACE%","un perfil"),a=e[n].params.url;break;case 7:o=o.replace("%PLACE%","un juego"),a=e[n].params.url}break;case 3:switch(o=1==e[n].total?"A %USER% le ha gustado %ITEM%.":2==e[n].total?"A %USER% y a otra persona les ha gustado %ITEM%.":"A %USER% y a otras %COUNT% personas les ha gustado %ITEM%.".replace("%COUNT%",e[n].total-1),e[n].place){case 1:o=o.replace("%ITEM%","tu mensaje en el foro"),a=e[n].params.url}break;case 4:o="Has recibido %DAYS% días afro.".replace("%DAYS%",e[n].params.time),a="/store";break;case 5:o="Se han sumado %AMOUNT% monedas en tu cuenta.".replace("%AMOUNT%",e[n].params.coins),a="/store";break;case 6:o="Has recibido un nuevo logro.",a=$("#go-profile").attr("href")+"/achievements";break;case 7:o="Un moderador te ha añadido una nueva incidencia.",a="/account/incidences";break;case 8:o="%USER% ha respondido tu solicitud de soporte.",a="/account/support";break;case 9:o="%USER% ha dejado un comentario en tu perfil.",a=$("#go-profile").attr("href")+"#"+e[n].params.comment;break;case 10:o="Tu cabecera ha sido denegada.",a="/account/profile";break;case 11:o="Tu imagen de perfil ha sido denegada.",a="/account/profile";break;case 12:o="Tu biografía ha sido rechazada.",a="/account/profile";break;case 13:o="Tu nombre ha sido rechazado.",a="/account";break;case 14:o='%USER% ha respondido en el tema "%TOPIC%"'.replace("%TOPIC%",e[n].params.title),a="/forum/topic/"+e[n].id_item+"/new#new";break;case 15:o="Tu sitio web ha sido rechazado.",a="/account";break;case 16:o="Tu video de perfil ha sido rechazado.",a="/account/profile";break;case 17:o="Se ha añadido/editado la respuesta de tu petición #%NUMBER%.".replace("%NUMBER%",e[n].params.id),a="/";break;case 18:o="Se ha editado el estado de tu petición #%NUMBER%.".replace("%NUMBER%",e[n].params.id),a="/"}o=o.replace("%USER%","<b>"+s.name+"</b>"),i+='<a href="'+a+'"><div data-new data-id="'+e[n].id+'" class="notification'+(0==e[n].seen?" unseen":"")+'"><img style="float:left;margin-right: 8px;border-radius: 100%;width: 40px;height: 40px;background-size: cover;background-repeat: no-repeat;background-position: center center!important;" src="'+s.avatar+'"><div style="vertical-align: middle;display: table-cell;width: 100%;font-size: 13px;">'+o+"</div></div></a>"}$("#notifications-box > .content > .body")[t](i),$(".notification[data-new]").click(function(){window.location=$(this).parent().attr("href")}).removeAttr("data-new")},close:function(){Notifications.opened=!1,$("#notifications-box").remove(),$("#notifications-background").remove(),$(document).unbind("click",Notifications.close)}},Status={services:{},running:!1,init:function(){var e=this,t=function(){var t={};for(var i in e.services)t[e.services[i].name]="function"!=typeof e.services[i].beforeCallback||e.services[i].beforeCallback();Api.get("/status",t,function(t){for(var i in e.services)e.services[i].afterCallback(t)})};!e.running&&Object.keys(e.services).length>0&&(e.running=!0,e.interval=setInterval(t,1e4)),t()},add:function(e,t,i){var n=t,o=i;"function"!=typeof i&&(n=!0,o=t),this.services[e]={name:e,beforeCallback:n,afterCallback:o},this.init()},remove:function(e){delete this.services[e],0==Object.keys(this.services).length&&(this.running=!1,clearInterval(this.interval))}},Time={init:function(){moment.locale(Language.code),"es"===Language.code?(Time.date_short="[el] D [de] MMMM [a las] HH:mm",Time.date_long="[el] D [de] MMMM [de] YYYY [a las] HH:mm"):(Time.date_short="[on] MMMM Do [at] HH:mm",Time.date_long="[on] MMMM Do, YYYY [at] HH:mm")},toString:function(e){var t=moment(),i=moment.unix(e);return Math.abs(i.diff(t,"hours"))<=22?i.fromNow():i.isSame(t.clone().subtract(1,"days"),"day")||i.isSame(t,"day")||i.isSame(t.clone().add(1,"days"),"day")?i.calendar():i.isSame(t,"year")?i.format(Time.date_short):i.format(Time.date_long)},getHTML:function(e){var t=moment(e);return'<time datetime="'+t.toISOString()+'" title="'+t.format(Time.date_long)+'" data-timestamp="'+e+'">'+Time.toString(e)+"</time>"},getDayName:function(e){return moment().weekday(e).format("dddd")},getMonthName:function(e){return moment().month(e).format("MMMM")}},Visor={open:function(e){function t(){Header.fixed=!0,$("#menu").css("position","fixed").css("top",0),$("header").hide(),$("body").css("overflow","hidden"),$("body").append('<div id="visor-exterior"></div><div id="visor-box"><div class="gap"></div><div class="box" style="width:'+e.width+"px;"+(e.height?"height:"+e.height+"px;":"")+'"><div style="height: 30px;">'+(e.title?'<div style="margin: 8px 12px;display: inline-flex;font-size: 16px;color: grey;text-align: center;">'+e.title+"</div>":"")+'<span id="visor-close" class="glyphicons glyphicons-remove-2" aria-hidden="true"></span></div>'+e.body+'</div><div class="gap"></div></div>'),$("#visor-box").fadeIn("fast"),$("#visor-exterior").click(Visor.close),$("#visor-box > .gap").click(Visor.close),$("#visor-close").click(Visor.close)}$(document).scrollTop()<106?$("body").animate({scrollTop:"106px"},200,t):t()},close:function(){Visor.onClose&&Visor.onClose(),$("#visor-exterior").remove(),$("#visor-box").remove(),$("header").show(),$("body").css("overflow","")}};$(document).ready(function(){$("#avatar_upload").attr("disabled",!0),$("#avatar_upload_image").change(function(){0!=$(this).val().length?$("#avatar_upload").attr("disabled",!1):$("#avatar_upload").attr("disabled",!0)})}),$(document).ready(function(){$("#head_upload").attr("disabled",!0),$("#head_upload_image").change(function(){0!=$(this).val().length?$("#head_upload").attr("disabled",!1):$("#head_upload").attr("disabled",!0)})}),$(document).ready(function(){function e(){n==o?($("#headlines").stop().animate({marginTop:"0px"},450),n=1):($("#headlines").stop().animate({marginTop:-(150*n)+"px"},450),n++)}Language.init(),Time.init();var t=(new Date).getHours();t>=6&&t<8||t>=17&&t<21?$("header").addClass("morning-afternoon"):t>=8&&t<17?$("header").addClass("day"):(t<6||t>=21)&&$("header").addClass("night"),Header.init(),App.isLogged()&&(Messages.init(),Notifications.init(),$(".dropdown-toggle").click(function(){$(this).parent().children(".dropdown-menu").toggle()})),Language.get(["main.cookies_message","main.cookies_dismiss","main.cookies_learnMore"]).then(function(e){window.cookieconsent.initialise({content:{message:e[0],dismiss:e[1],link:e[2],href:"/terms#3"},elements:{messagelink:'<span id="cookieconsent:desc" class="cc-message">{{message}} <a aria-label="learn more about cookies" tabindex="0" class="cc-link" href="{{href}}">{{link}}</a>.</span>'},position:"bottom",theme:"classic"})}),""==App.get(1)||"home"==App.get(1)||"forum"==App.get(1)||"articles"==App.get(1)||("events"==App.get(1)?App.get(2)?"winners"==App.get(2)?$(".btn-winners").addClass("active"):"help"==App.get(2)&&$(".btn-help").addClass("active"):$(".btn-home").addClass("active"):"furni"==App.get(1)?App.get(2)?"search"==App.get(2)?$(".btn-search").addClass("active"):"recent"==App.get(2)?$(".btn-latest").addClass("active"):"edited"==App.get(2)?$(".btn-edited").addClass("active"):"liked"==App.get(2)?$(".btn-liked").addClass("active"):"help"==App.get(2)&&$(".btn-help").addClass("active"):$(".btn-home").addClass("active"):"extras"==App.get(1)?App.get(2)&&"texts"!=App.get(2)?"characters"==App.get(2)?$(".btn-characters").addClass("active"):"info"==App.get(2)?$(".btn-info").addClass("active"):"badges"==App.get(2)?$(".btn-badges").addClass("active"):"ranking"==App.get(2)&&$(".btn-ranking").addClass("active"):$(".btn-texts").addClass("active"):"statistics"==App.get(1)?App.get(2)?"community"==App.get(2)?$(".btn-community").addClass("active"):"messages"==App.get(2)?$(".btn-messages").addClass("active"):"achievements"==App.get(2)&&$(".btn-achievements").addClass("active"):$(".btn-home").addClass("active"):"account"==App.get(1)?App.get(2)?"security"==App.get(2)?$(".btn-security").addClass("active"):"privacy"==App.get(2)?$(".btn-privacy").addClass("active"):"profile"==App.get(2)?$(".btn-profile").addClass("active"):"incidences"==App.get(2)?$(".btn-incidences").addClass("active"):"support"==App.get(2)&&$(".btn-support").addClass("active"):$(".btn-account").addClass("active"):"messages"==App.get(1)&&Messages.open(!0,App.get(2))),$(function(){$(".lightbox-img").lightBox()});var i=150*($("#headlines .headline").length/3);$("#headlines").height(i);var n=1,o=i/150;setInterval(function(){e()},1e4);$(".notice").click(function(){$(this).addClass("hide")})}),function(e){e.fn.drags=function(t){t=e.extend({handle:"",cursor:"",draggableClass:"draggable",activeHandleClass:"active-handle"},t);var i=null,n=""===t.handle?this:this.find(t.handle);return n.css("cursor",t.cursor).on("mousedown",function(n){""===t.handle?(i=e(this),i.addClass(t.draggableClass)):(i=e(this).parent(),i.addClass(t.draggableClass).find(t.handle).addClass(t.activeHandleClass));var o=i.outerHeight(),a=i.outerWidth(),s=i.offset().top+o-n.pageY,r=i.offset().left+a-n.pageX;e(document).on("mousemove",function(e){i.offset({top:e.pageY+s-o,left:e.pageX+r-a})}).on("mouseup",function(){e(this).off("mousemove"),i.removeClass(t.draggableClass),i=null}),n.preventDefault()}).on("mouseup",function(){""===t.handle?i.removeClass(t.draggableClass):i.removeClass(t.draggableClass).find(t.handle).removeClass(t.activeHandleClass),i=null})}}(jQuery),$(function(){$(".draggable").drags()}),$(function(){var e=$("[rel~=tooltip]"),t=!1,i=!1,n=!1;e.bind("mouseenter",function(){if(t=$(this),n=t.data("name"),description=t.data("description"),i=$('<div id="tooltip"></div>'),"furni.price"==description){var e=$.parseJSON(t.children().html());0==e.goldbars?0==e.credits?description="-":description=e.credits+' <img src="/images/furni_credits.png" />':0==e.credits?description=e.goldbars+' <img src="/images/furni_goldbars.png" />':description=e.goldbars+' <img src="/images/furni_goldbars.png" /> + '+e.credits+' <img src="/images/furni_credits.png" />'}i.css("opacity",0).html('<div class="title">'+n+'</div><div class="description">'+description+"</div>").appendTo("body");var o=function(){$(window).width()<1.5*i.outerWidth()?i.css("max-width",$(window).width()/2):i.css("max-width",340);var e=t.offset().left+t.outerWidth()/2-i.outerWidth()/2,n=t.offset().top-i.outerHeight()-20;if(e<0?(e=t.offset().left+t.outerWidth()/2-20,i.addClass("left")):i.removeClass("left"),e+i.outerWidth()>$(window).width()?(e=t.offset().left-i.outerWidth()+t.outerWidth()/2+20,i.addClass("right")):i.removeClass("right"),n<0){var n=t.offset().top+t.outerHeight();i.addClass("top")}else i.removeClass("top");i.css({left:e,top:n}).animate({top:"+=10",opacity:1},50)};o(),$(window).resize(o);var a=function(){i.animate({top:"-=10",opacity:0},50,function(){$(this).remove()})};t.bind("mouseleave",a),i.bind("click",a)})}),function(e){e.fn.lightBox=function(t){function i(){return n(this,b),!1}function n(i,n){if(e("embed, object, select").css({visibility:"hidden"}),o(),t.imageArray.length=0,t.activeImage=0,1==n.length)t.imageArray.push(new Array(i.getAttribute("href"),i.getAttribute("title")));else for(var s=0;s<n.length;s++)t.imageArray.push(new Array(n[s].getAttribute("href"),n[s].getAttribute("title")));for(;t.imageArray[t.activeImage][0]!=i.getAttribute("href");)t.activeImage++;a()}function o(){e("body").append('<div id="jquery-overlay"></div><div id="jquery-lightbox"><div id="lightbox-container-image-box"><div id="lightbox-container-image"><img id="lightbox-image"><div style="" id="lightbox-nav"><a href="#" id="lightbox-nav-btnPrev"></a><a href="#" id="lightbox-nav-btnNext"></a></div><div id="lightbox-loading"><a href="#" id="lightbox-loading-link"><img src="'+t.imageLoading+'"></a></div></div></div></div>');var i=m();e("#jquery-overlay").css({backgroundColor:t.overlayBgColor,opacity:t.overlayOpacity,width:i[0],height:i[1]}).fadeIn();var n=f();e("#jquery-lightbox").css({top:n[1]+i[3]/10,left:n[0]}).show(),e("#jquery-overlay,#jquery-lightbox").click(function(){h()}),e("#lightbox-loading-link,#lightbox-secNav-btnClose").click(function(){return h(),!1}),e(window).resize(function(){var t=m();e("#jquery-overlay").css({width:t[0],height:t[1]});var i=f();e("#jquery-lightbox").css({top:i[1]+t[3]/10,left:i[0]})})}function a(){e("#lightbox-loading").show(),t.fixedNavigation?e("#lightbox-image,#lightbox-container-image-data-box,#lightbox-image-details-currentNumber").hide():e("#lightbox-image,#lightbox-nav,#lightbox-nav-btnPrev,#lightbox-nav-btnNext,#lightbox-container-image-data-box,#lightbox-image-details-currentNumber").hide();var i=new Image;i.onload=function(){e("#lightbox-image").attr("src",t.imageArray[t.activeImage][0]),s(i.width,i.height),i.onload=function(){}},i.src=t.imageArray[t.activeImage][0]}function s(i,n){var o=e("#lightbox-container-image-box").width(),a=e("#lightbox-container-image-box").height(),s=i+2*t.containerBorderSize,c=n+2*t.containerBorderSize,l=o-s,d=a-c;e("#lightbox-container-image-box").animate({width:s,height:c},t.containerResizeSpeed,function(){r()}),0==l&&0==d&&v(e.browser.msie?250:100),e("#lightbox-container-image-data-box").css({width:i}),e("#lightbox-nav-btnPrev,#lightbox-nav-btnNext").css({height:n+2*t.containerBorderSize})}function r(){e("#lightbox-loading").hide(),e("#lightbox-image").fadeIn(function(){c(),l()}),g()}function c(){e("#lightbox-container-image-data-box").slideDown("fast"),e("#lightbox-image-details-caption").hide(),t.imageArray[t.activeImage][1]&&e("#lightbox-image-details-caption").html(t.imageArray[t.activeImage][1]).show(),t.imageArray.length>1&&e("#lightbox-image-details-currentNumber").html(t.txtImage+" "+(t.activeImage+1)+" "+t.txtOf+" "+t.imageArray.length).show()}function l(){e("#lightbox-nav").show(),e("#lightbox-nav-btnPrev,#lightbox-nav-btnNext").css({background:"transparent url() no-repeat"}),0!=t.activeImage&&(t.fixedNavigation?e("#lightbox-nav-btnPrev").css({background:"url() left 15% no-repeat"}).unbind().bind("click",function(){return t.activeImage=t.activeImage-1,a(),!1}):e("#lightbox-nav-btnPrev").unbind().hover(function(){e(this).css({background:"url() left 15% no-repeat"})},function(){e(this).css({background:"transparent url() no-repeat"})}).show().bind("click",function(){return t.activeImage=t.activeImage-1,a(),!1})),t.activeImage!=t.imageArray.length-1&&(t.fixedNavigation?e("#lightbox-nav-btnNext").css({background:"url() right 15% no-repeat"}).unbind().bind("click",function(){return t.activeImage=t.activeImage+1,a(),!1}):e("#lightbox-nav-btnNext").unbind().hover(function(){e(this).css({background:"url() right 15% no-repeat"})},function(){e(this).css({background:"transparent url() no-repeat"})}).show().bind("click",function(){return t.activeImage=t.activeImage+1,a(),!1})),d()}function d(){e(document).keydown(function(e){p(e)})}function u(){e(document).unbind()}function p(e){null==e?(keycode=event.keyCode,escapeKey=27):(keycode=e.keyCode,escapeKey=e.DOM_VK_ESCAPE),key=String.fromCharCode(keycode).toLowerCase(),key!=t.keyToClose&&"x"!=key&&keycode!=escapeKey||h(),key!=t.keyToPrev&&37!=keycode||0!=t.activeImage&&(t.activeImage=t.activeImage-1,a(),u()),key!=t.keyToNext&&39!=keycode||t.activeImage!=t.imageArray.length-1&&(t.activeImage=t.activeImage+1,a(),u())}function g(){t.imageArray.length-1>t.activeImage&&(objNext=new Image,objNext.src=t.imageArray[t.activeImage+1][0]),t.activeImage>0&&(objPrev=new Image,objPrev.src=t.imageArray[t.activeImage-1][0])}function h(){e("#jquery-lightbox").remove(),e("#jquery-overlay").fadeOut(function(){e("#jquery-overlay").remove()}),e("embed, object, select").css({visibility:"visible"})}function m(){var e,t;window.innerHeight&&window.scrollMaxY?(e=window.innerWidth+window.scrollMaxX,t=window.innerHeight+window.scrollMaxY):document.body.scrollHeight>document.body.offsetHeight?(e=document.body.scrollWidth,t=document.body.scrollHeight):(e=document.body.offsetWidth,t=document.body.offsetHeight);var i,n;return self.innerHeight?(i=document.documentElement.clientWidth?document.documentElement.clientWidth:self.innerWidth,n=self.innerHeight):document.documentElement&&document.documentElement.clientHeight?(i=document.documentElement.clientWidth,n=document.documentElement.clientHeight):document.body&&(i=document.body.clientWidth,n=document.body.clientHeight),t<n?pageHeight=n:pageHeight=t,e<i?pageWidth=e:pageWidth=i,arrayPageSize=new Array(pageWidth,pageHeight,i,n),arrayPageSize}function f(){var e,t;return self.pageYOffset?(t=self.pageYOffset,e=self.pageXOffset):document.documentElement&&document.documentElement.scrollTop?(t=document.documentElement.scrollTop,e=document.documentElement.scrollLeft):document.body&&(t=document.body.scrollTop,e=document.body.scrollLeft),arrayPageScroll=new Array(e,t),arrayPageScroll}function v(e){var t=new Date;i=null;do var i=new Date;while(i-t<e)}t=jQuery.extend({overlayBgColor:"#000",overlayOpacity:.8,fixedNavigation:!1,imageLoading:"/images/loading.gif",containerBorderSize:10,containerResizeSpeed:400,txtImage:"Imagen",txtOf:"de",keyToClose:"c",keyToPrev:"p",keyToNext:"n",imageArray:[],activeImage:0},t);var b=this;return this.unbind("click").click(i)}}(jQuery),$(document).ready(function(){void 0!=$("#hinfo-site")[0]&&hinfo_init(),void 0!=$("#binfo-site")[0]&&binfo_init(),void 0!=$("#fgenerator-site")[0]&&fgenerator_init(),void 0!=$("#hcreator-site")[0]&&hcreator_init()});var user,Forum={topic:App.get(3),init:function(){Forum.replies.init(),Forum.likes.init(),"edit"==App.get(2)&&$(document).scrollTop($("main").offset().top-$("#menu").height()-10),"reply"==App.get(2)&&(Forum.replyListener(),Forum.spoilerListener()),"topic"==App.get(2)&&($(".btn-follow").click(function(e){e.preventDefault();var t=$(this);Api.post("/forum/"+Forum.topic,{follow:!t.hasClass("active")},function(e){"success"==e.status&&(t.hasClass("active")?Language.get("main.item_follow").then(function(e){$(".btn-follow").removeClass("active").children(".text").text(e[0])}):(Language.get("main.item_following").then(function(e){$(".btn-follow").addClass("active animated zoomIn noClick").children(".text").text(e[0])}),setTimeout(function(){$(".btn-follow").removeClass("noClick animated zoomIn")},1e3)))})}).hover(function(){$(this).hasClass("active")&&Language.get("main.item_stop_follow").then(function(e){$(this).children(".text").text(e[0])})},function(){$(this).hasClass("active")&&Language.get("main.item_following").then(function(e){$(this).children(".text").text(e[0])})}),Forum.spoilerListener(),$(".btn-reply-all").click(function(e){e.preventDefault();var t=Lockr.get("replies");t?(t="/"+t.toString(),window.location.href=$(this).attr("href")+t,Forum.replies.remove()):$.get("/templates/forum.reply.html",function(e){history.pushState({action:"reply-all"},History.title,"/forum/reply/"+App.get(3)),Visor.open({body:e,width:940,title:"Respondiendo al tema"}),Visor.onClose=function(){history.pushState({action:"topic"},History.title,"/forum/topic/"+App.get(3)),Visor.onClose=null},Forum.replyListener()})}),history.replaceState({action:"topic"},History.title,null),window.addEventListener("popstate",function(e){e.state&&("reply-all"==e.state.action?$(".btn-reply-all").first().click():"topic"==e.state.action&&Visor.close())}))},replyListener:function(){if(!App.get(4)){var e="forum-reply-"+Forum.topic,t=Lockr.get(e),i=function(){$("#reply_body").val()?Lockr.set(e,$("#reply_body").val(),5):Lockr.rm(e)};t&&$("#reply_body").val(t);var n=!1;$("#reply_body").keypress(function(e){n||(n=!0,setTimeout(function(){i(),n=!1},3e3))}).on("change",i),setTimeout(function(){setCaretPosition($("#reply_body"),0),$("form .button[name=reply], form > a.btn-cancel").click(function(){Lockr.rm(e)})},1e3)}},spoilerListener:function(){$(".btn-spoiler").click(function(){var e=$(this),t=e.hasClass("active");e.next()[t?"slideUp":"slideDown"]("fast",function(){Language.get((t?"show":"hide")+"_content").then(function(i){e.toggleClass("active",!t).html(i[0])})})}),$(".btn-spoiler-all").click(function(e){e.preventDefault();var t=$(this),i=t.parent().parent().children(".text").find(".decoda-spoiler-button");t.hasClass("active")?(t.removeClass("active").children("span").removeClass("halflings-resize-small"),i.removeClass("spoiler-open").click()):(t.addClass("active").children("span").addClass("halflings-resize-small"),i.addClass("spoiler-open").click())})},likes:{init:function(){var e=$(".btn-like");!function t(){e[0]&&Api.get("/likes/status/message/"+$(e[0]).data("id"),{},function(i){Forum.likes.status($(e[0])),e.splice(0,1),t()})}(),e.mouseenter(function(){var e=$(this),t=e.parent();timeout=setTimeout(function(){Language.get("main.item_liked").then(function(i){e.popover({title:i[0],container:t,html:!0,placement:"bottom",content:'<center><img src="//cdn.habtium.com/management/ajax-loader.gif"></center>',trigger:"manual"}),e.popover("show")}),Api.get("/likes/message/"+e.data("id"),{},function(i){i.error?"empty_set"==i.error.identifier&&Language.get("main.item_liked_nobody").then(function(t){e.data("bs.popover").options.content=t[0],e.popover("show")}):Accounts.getIfNot(i,function(){var t="";for(var n in i){var o=accounts[i[n]];t+='<div style="display: table;"><a title="'+o.username+'" href="/'+o.username+'"><img style="display: table-cell;width: 25px;height: 25px;border-radius: 100%;background-size: cover;background-repeat: no-repeat;background-position: center center!important;" width="25" src="'+o.avatar+'" /></a><a style="display:table-cell;" href="/'+o.username+'">'+o.username+"</a></div>"}e.data("bs.popover").options.content=t,e.popover("show")}),t.mouseleave(function(){e.popover("hide")})})},1e3),t.mouseleave(function(){clearTimeout(timeout)})}).click(function(e){e.preventDefault(),clearTimeout(timeout);var t=$(this);t.hasClass("active")?Api.delete("/likes/message/"+t.data("id"),{},function(e){e.success&&(t.removeClass("active"),Forum.likes.status(t))}):Api.post("/likes/message/"+t.data("id"),{},function(e){e.success&&(t.addClass("active animated zoomIn"),setTimeout(function(){t.removeClass("animated zoomIn")},1e3),Forum.likes.status(t))})})},status:function(e){Api.get("/likes/status/message/"+e.data("id"),{},function(t){e.children(".count").html(0==t.amount?"":t.amount),t.liked&&e.addClass("active")})}},replies:{init:function(){var e,t=!1;Lockr.get("replies-topic")!=Forum.topic&&Forum.replies.remove(),$(".btn-reply").mousedown(function(){if(!$(this).hasClass("active")){var i=$(this);e=setTimeout(function(){var e=Forum.replies.get();e.push(i.data("id")),Lockr.set("replies",e),t||(Lockr.set("replies-topic",Forum.topic),t=!0),i.addClass("active animated zoomIn noClick"),setTimeout(function(){i.removeClass("noClick animated zoomIn")},1e3)},500),i.mouseleave(function(){clearTimeout(e)}).mouseup(function(){clearTimeout(e)})}}).click(function(t){if(t.preventDefault(),!$(this).hasClass("noClick"))if($(this).hasClass("active")){$(this).removeClass("active");var i=Forum.replies.get(),n=i.indexOf($(this).data("id"));n>-1&&i.splice(n,1),Lockr.set("replies",i)}else window.location.href=$(this).attr("href");e=null})},get:function(){var e=Lockr.get("replies");return e||(e=[]),e},remove:function(){Lockr.rm("replies"),Lockr.rm("replies-topic")}}};if("undefined"==typeof jQuery)throw new Error("Bootstrap's JavaScript requires jQuery");+function(e){"use strict";var t=e.fn.jquery.split(" ")[0].split(".");if(t[0]<2&&t[1]<9||1==t[0]&&9==t[1]&&t[2]<1||t[0]>3)throw new Error("Bootstrap's JavaScript requires jQuery version 1.9.1 or higher, but lower than version 4")}(jQuery),+function(e){"use strict";function t(t){return this.each(function(){var n=e(this),o=n.data("bs.tooltip"),a="object"==typeof t&&t;!o&&/destroy|hide/.test(t)||(o||n.data("bs.tooltip",o=new i(this,a)),"string"==typeof t&&o[t]())})}var i=function(e,t){this.type=null,this.options=null,this.enabled=null,this.timeout=null,this.hoverState=null,this.$element=null,this.inState=null,this.init("tooltip",e,t)};i.VERSION="3.3.7",i.TRANSITION_DURATION=150,i.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0}},i.prototype.init=function(t,i,n){if(this.enabled=!0,this.type=t,this.$element=e(i),this.options=this.getOptions(n),this.$viewport=this.options.viewport&&e(e.isFunction(this.options.viewport)?this.options.viewport.call(this,this.$element):this.options.viewport.selector||this.options.viewport),this.inState={click:!1,hover:!1,focus:!1},this.$element[0]instanceof document.constructor&&!this.options.selector)throw new Error("`selector` option must be specified when initializing "+this.type+" on the window.document object!");for(var o=this.options.trigger.split(" "),a=o.length;a--;){var s=o[a];if("click"==s)this.$element.on("click."+this.type,this.options.selector,e.proxy(this.toggle,this));else if("manual"!=s){var r="hover"==s?"mouseenter":"focusin",c="hover"==s?"mouseleave":"focusout";this.$element.on(r+"."+this.type,this.options.selector,e.proxy(this.enter,this)),this.$element.on(c+"."+this.type,this.options.selector,e.proxy(this.leave,this))}}this.options.selector?this._options=e.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},i.prototype.getDefaults=function(){return i.DEFAULTS},i.prototype.getOptions=function(t){return t=e.extend({},this.getDefaults(),this.$element.data(),t),t.delay&&"number"==typeof t.delay&&(t.delay={show:t.delay,hide:t.delay}),t},i.prototype.getDelegateOptions=function(){var t={},i=this.getDefaults();return this._options&&e.each(this._options,function(e,n){i[e]!=n&&(t[e]=n)}),t},i.prototype.enter=function(t){var i=t instanceof this.constructor?t:e(t.currentTarget).data("bs."+this.type);return i||(i=new this.constructor(t.currentTarget,this.getDelegateOptions()),e(t.currentTarget).data("bs."+this.type,i)),t instanceof e.Event&&(i.inState["focusin"==t.type?"focus":"hover"]=!0),i.tip().hasClass("in")||"in"==i.hoverState?void(i.hoverState="in"):(clearTimeout(i.timeout),i.hoverState="in",i.options.delay&&i.options.delay.show?void(i.timeout=setTimeout(function(){"in"==i.hoverState&&i.show()},i.options.delay.show)):i.show())},i.prototype.isInStateTrue=function(){for(var e in this.inState)if(this.inState[e])return!0;return!1},i.prototype.leave=function(t){var i=t instanceof this.constructor?t:e(t.currentTarget).data("bs."+this.type);if(i||(i=new this.constructor(t.currentTarget,this.getDelegateOptions()),e(t.currentTarget).data("bs."+this.type,i)),t instanceof e.Event&&(i.inState["focusout"==t.type?"focus":"hover"]=!1),!i.isInStateTrue())return clearTimeout(i.timeout),i.hoverState="out",i.options.delay&&i.options.delay.hide?void(i.timeout=setTimeout(function(){"out"==i.hoverState&&i.hide()},i.options.delay.hide)):i.hide()},i.prototype.show=function(){var t=e.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(t);var n=e.contains(this.$element[0].ownerDocument.documentElement,this.$element[0]);if(t.isDefaultPrevented()||!n)return;var o=this,a=this.tip(),s=this.getUID(this.type);this.setContent(),a.attr("id",s),this.$element.attr("aria-describedby",s),this.options.animation&&a.addClass("fade");var r="function"==typeof this.options.placement?this.options.placement.call(this,a[0],this.$element[0]):this.options.placement,c=/\s?auto?\s?/i,l=c.test(r);l&&(r=r.replace(c,"")||"top"),a.detach().css({top:0,left:0,display:"block"}).addClass(r).data("bs."+this.type,this),this.options.container?a.appendTo(this.options.container):a.insertAfter(this.$element),this.$element.trigger("inserted.bs."+this.type);var d=this.getPosition(),u=a[0].offsetWidth,p=a[0].offsetHeight;if(l){var g=r,h=this.getPosition(this.$viewport);r="bottom"==r&&d.bottom+p>h.bottom?"top":"top"==r&&d.top-p<h.top?"bottom":"right"==r&&d.right+u>h.width?"left":"left"==r&&d.left-u<h.left?"right":r,a.removeClass(g).addClass(r)}var m=this.getCalculatedOffset(r,d,u,p);this.applyPlacement(m,r);var f=function(){var e=o.hoverState;o.$element.trigger("shown.bs."+o.type),o.hoverState=null,"out"==e&&o.leave(o)};e.support.transition&&this.$tip.hasClass("fade")?a.one("bsTransitionEnd",f).emulateTransitionEnd(i.TRANSITION_DURATION):f();

}},i.prototype.applyPlacement=function(t,i){var n=this.tip(),o=n[0].offsetWidth,a=n[0].offsetHeight,s=parseInt(n.css("margin-top"),10),r=parseInt(n.css("margin-left"),10);isNaN(s)&&(s=0),isNaN(r)&&(r=0),t.top+=s,t.left+=r,e.offset.setOffset(n[0],e.extend({using:function(e){n.css({top:Math.round(e.top),left:Math.round(e.left)})}},t),0),n.addClass("in");var c=n[0].offsetWidth,l=n[0].offsetHeight;"top"==i&&l!=a&&(t.top=t.top+a-l);var d=this.getViewportAdjustedDelta(i,t,c,l);d.left?t.left+=d.left:t.top+=d.top;var u=/top|bottom/.test(i),p=u?2*d.left-o+c:2*d.top-a+l,g=u?"offsetWidth":"offsetHeight";n.offset(t),this.replaceArrow(p,n[0][g],u)},i.prototype.replaceArrow=function(e,t,i){this.arrow().css(i?"left":"top",50*(1-e/t)+"%").css(i?"top":"left","")},i.prototype.setContent=function(){var e=this.tip(),t=this.getTitle();e.find(".tooltip-inner")[this.options.html?"html":"text"](t),e.removeClass("fade in top bottom left right")},i.prototype.hide=function(t){function n(){"in"!=o.hoverState&&a.detach(),o.$element&&o.$element.removeAttr("aria-describedby").trigger("hidden.bs."+o.type),t&&t()}var o=this,a=e(this.$tip),s=e.Event("hide.bs."+this.type);if(this.$element.trigger(s),!s.isDefaultPrevented())return a.removeClass("in"),e.support.transition&&a.hasClass("fade")?a.one("bsTransitionEnd",n).emulateTransitionEnd(i.TRANSITION_DURATION):n(),this.hoverState=null,this},i.prototype.fixTitle=function(){var e=this.$element;(e.attr("title")||"string"!=typeof e.attr("data-original-title"))&&e.attr("data-original-title",e.attr("title")||"").attr("title","")},i.prototype.hasContent=function(){return this.getTitle()},i.prototype.getPosition=function(t){t=t||this.$element;var i=t[0],n="BODY"==i.tagName,o=i.getBoundingClientRect();null==o.width&&(o=e.extend({},o,{width:o.right-o.left,height:o.bottom-o.top}));var a=window.SVGElement&&i instanceof window.SVGElement,s=n?{top:0,left:0}:a?null:t.offset(),r={scroll:n?document.documentElement.scrollTop||document.body.scrollTop:t.scrollTop()},c=n?{width:e(window).width(),height:e(window).height()}:null;return e.extend({},o,r,c,s)},i.prototype.getCalculatedOffset=function(e,t,i,n){return"bottom"==e?{top:t.top+t.height,left:t.left+t.width/2-i/2}:"top"==e?{top:t.top-n,left:t.left+t.width/2-i/2}:"left"==e?{top:t.top+t.height/2-n/2,left:t.left-i}:{top:t.top+t.height/2-n/2,left:t.left+t.width}},i.prototype.getViewportAdjustedDelta=function(e,t,i,n){var o={top:0,left:0};if(!this.$viewport)return o;var a=this.options.viewport&&this.options.viewport.padding||0,s=this.getPosition(this.$viewport);if(/right|left/.test(e)){var r=t.top-a-s.scroll,c=t.top+a-s.scroll+n;r<s.top?o.top=s.top-r:c>s.top+s.height&&(o.top=s.top+s.height-c)}else{var l=t.left-a,d=t.left+a+i;l<s.left?o.left=s.left-l:d>s.right&&(o.left=s.left+s.width-d)}return o},i.prototype.getTitle=function(){var e,t=this.$element,i=this.options;return e=t.attr("data-original-title")||("function"==typeof i.title?i.title.call(t[0]):i.title)},i.prototype.getUID=function(e){do e+=~~(1e6*Math.random());while(document.getElementById(e));return e},i.prototype.tip=function(){if(!this.$tip&&(this.$tip=e(this.options.template),1!=this.$tip.length))throw new Error(this.type+" `template` option must consist of exactly 1 top-level element!");return this.$tip},i.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},i.prototype.enable=function(){this.enabled=!0},i.prototype.disable=function(){this.enabled=!1},i.prototype.toggleEnabled=function(){this.enabled=!this.enabled},i.prototype.toggle=function(t){var i=this;t&&(i=e(t.currentTarget).data("bs."+this.type),i||(i=new this.constructor(t.currentTarget,this.getDelegateOptions()),e(t.currentTarget).data("bs."+this.type,i))),t?(i.inState.click=!i.inState.click,i.isInStateTrue()?i.enter(i):i.leave(i)):i.tip().hasClass("in")?i.leave(i):i.enter(i)},i.prototype.destroy=function(){var e=this;clearTimeout(this.timeout),this.hide(function(){e.$element.off("."+e.type).removeData("bs."+e.type),e.$tip&&e.$tip.detach(),e.$tip=null,e.$arrow=null,e.$viewport=null,e.$element=null})};var n=e.fn.tooltip;e.fn.tooltip=t,e.fn.tooltip.Constructor=i,e.fn.tooltip.noConflict=function(){return e.fn.tooltip=n,this}}(jQuery),+function(e){"use strict";function t(t){return this.each(function(){var n=e(this),o=n.data("bs.popover"),a="object"==typeof t&&t;!o&&/destroy|hide/.test(t)||(o||n.data("bs.popover",o=new i(this,a)),"string"==typeof t&&o[t]())})}var i=function(e,t){this.init("popover",e,t)};if(!e.fn.tooltip)throw new Error("Popover requires tooltip.js");i.VERSION="3.3.7",i.DEFAULTS=e.extend({},e.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),i.prototype=e.extend({},e.fn.tooltip.Constructor.prototype),i.prototype.constructor=i,i.prototype.getDefaults=function(){return i.DEFAULTS},i.prototype.setContent=function(){var e=this.tip(),t=this.getTitle(),i=this.getContent();e.find(".popover-title")[this.options.html?"html":"text"](t),e.find(".popover-content").children().detach().end()[this.options.html?"string"==typeof i?"html":"append":"text"](i),e.removeClass("fade top bottom left right in"),e.find(".popover-title").html()||e.find(".popover-title").hide()},i.prototype.hasContent=function(){return this.getTitle()||this.getContent()},i.prototype.getContent=function(){var e=this.$element,t=this.options;return e.attr("data-content")||("function"==typeof t.content?t.content.call(e[0]):t.content)},i.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")};var n=e.fn.popover;e.fn.popover=t,e.fn.popover.Constructor=i,e.fn.popover.noConflict=function(){return e.fn.popover=n,this}}(jQuery),$(document).ready(Forum.init);var Store={buy:function(e,t){Api.post("/store/buy",{item:e,id:t},function(i){if(i.success){switch(Store.update(i.coins,i.afro,i.achievement,i.renamings),e){case"afro":var n="Has comprado satisfactoriamente %AMOUNT% mes(es) de Afro.".replace("%AMOUNT%",t);break;case"achievement":var n;Language.get(["achievements."+t+".name","accounts.store_bought"]).then(function(e){n="Has comprado satisfactoriamente %ACH_NAME%.".replace("%ACH_NAME%",e[0]),$(".b_ach-"+t).removeClass("green").addClass("red disabled").html('<span class="glyphicons glyphicons-shopping-cart"></span> '+e[1])});break;case"renamings":var n="Has comprado un cambio de nombre exitosamente. Puedes utilizarlo yendo al apartado de cuenta cuando desees.";Language.get("accounts.store_bought").then(function(e){$(".buy_renamings").removeClass("green").addClass("red disabled").html('<span class="glyphicons glyphicons-shopping-cart"></span> '+e[0])})}Alert.push([{type:"success",text:n,icon:"circle-ok"}])}else switch(i.error.identifier){case"insufficient_coins":Alert.push([{type:"danger",text:"No tienes monedas suficientes para realizar la compra.",icon:"warning-sign"}]),$(".buy_"+e).each(function(){$(this).removeClass("green").addClass("red disabled")});break;case"no_query":Alert.push([{type:"danger",text:"El servicio que intentas comprar no está disponible.",icon:"warning-sign"}]);break;case"already_exists":Alert.push([{type:"danger",text:"Ya compraste anteriormente este %ITEM%".replace("%ITEM%","achievement"==e?"logro":"cambio de nombre."),icon:"warning-sign"}]);break;case"wrong_item":Alert.push([{type:"danger",text:"El servicio que intentas comprar no existe.",icon:"warning-sign"}])}})},update:function(e,t,i,n){void 0!=e&&$("#account_coins").html(number_format(parseInt($("#account_coins").html().replace(/\./g,""))+parseInt(e),0,",",".")),void 0!=t&&Language.get([["accounts.store_afro_days",{NUMBER:Math.ceil(t/86400)}]]).then(function(e){$("#account_afro").html(e[0])}),void 0!=i&&$("#account_achievements").html(parseInt($("#account_achievements").html())+1),void 0!=n&&$("#account_renamings").html(parseInt($("#account_renamings").html())+1)}},Voucher={redeem:function(){$("#store_redeem").submit(function(e){e.preventDefault(),Api.post("/vouchers/redeem",{voucher:$("#store_redeem_string").attr("disabled",!0).val()},function(e){if(e.error)switch(e.error.identifier){case"not_found":Alert.push([{type:"danger",text:"El código que has introducido no existe o ya ha sido canjeado por alguien más.",icon:"warning-sign"}]);break;case"param_null":Alert.push([{type:"danger",text:"El campo de texto del código está vacío.",icon:"warning-sign"}])}else $("#store_redeem_string").val(""),Alert.push([{type:"success",text:"El código ha sido canjeado exitosamente.",icon:"circle-ok"}]),Store.update(e.coins,e.afro,e.achievement,e.renamings);$("#store_redeem_string").attr("disabled",!1)})})}};